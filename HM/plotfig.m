% Plot Area
%% 64
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

E2A = load('data/E2_64_25_dataA.txt');
E2B = load('data/E2_64_25_dataB.txt');
E4A = load('data/E4_64_25_dataA.txt');
E4B = load('data/E4_64_25_dataB.txt');
S3A = load('data/S3_64_25_dataA.txt');
S3B = load('data/S3_64_25_dataB.txt');
I4A = load('data/I4_64_25_dataA.txt');
I4B = load('data/I4_64_25_dataB.txt');
I6A = load('data/I6_64_25_dataA.txt');
I6B = load('data/I6_64_25_dataB.txt');
figure;
plot(S3A(:,1),S3A(:,2)*alpha,'-*',E2A(:,1),E2A(:,2)*alpha,'--+',E4A(:,1),E4A(:,2)*alpha,'--+',I4A(:,1),I4A(:,2)*alpha,'--<',I6A(:,1),I6A(:,2)*alpha,'-->',S3A(:,1),S3A(:,3)*alpha,'black --^');
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Convection Simulation for different scheme at N = 64 \tau = 0.25');
legend('Decentered O3','Centered E2','Centered E4','Implicit I4','Implicit I6','Exact Solution');
grid on;
grid minor;
axis([0,64,-0.5,1.2]);
%% 128
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

E2A = load('data/E2_128_25_dataA.txt');
E2B = load('data/E2_128_25_dataB.txt');
E4A = load('data/E4_128_25_dataA.txt');
E4B = load('data/E4_128_25_dataB.txt');
S3A = load('data/S3_128_25_dataA.txt');
S3B = load('data/S3_128_25_dataB.txt');
I4A = load('data/I4_128_25_dataA.txt');
I4B = load('data/I4_128_25_dataB.txt');
I6A = load('data/I6_128_25_dataA.txt');
I6B = load('data/I6_128_25_dataB.txt');
figure;
plot(S3A(:,1),S3A(:,2)*alpha,'-*',E2A(:,1),E2A(:,2)*alpha,'--+',E4A(:,1),E4A(:,2)*alpha,'--+',I4A(:,1),I4A(:,2)*alpha,'--<',I6A(:,1),I6A(:,2)*alpha,'-->',S3A(:,1),S3A(:,3)*alpha,'black --^');
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Convection Simulation for different scheme at N = 128 \tau = 0.25');
legend('Decentered O3','Centered E2','Centered E4','Implicit I4','Implicit I6','Exact Solution');
grid on;
grid minor;
axis([0,128,-0.5,1.2]);
%% 256
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

E2A = load('data/E2_256_25_dataA.txt');
E2B = load('data/E2_256_25_dataB.txt');
E4A = load('data/E4_256_25_dataA.txt');
E4B = load('data/E4_256_25_dataB.txt');
S3A = load('data/S3_256_25_dataA.txt');
S3B = load('data/S3_256_25_dataB.txt');
I4A = load('data/I4_256_25_dataA.txt');
I4B = load('data/I4_256_25_dataB.txt');
I6A = load('data/I6_256_25_dataA.txt');
I6B = load('data/I6_256_25_dataB.txt');
figure;
plot(S3A(:,1),S3A(:,2)*alpha,'-*',E2A(:,1),E2A(:,2)*alpha,'--+',E4A(:,1),E4A(:,2)*alpha,'--+',I4A(:,1),I4A(:,2)*alpha,'--<',I6A(:,1),I6A(:,2)*alpha,'-->',S3A(:,1),S3A(:,3)*alpha,'black --^');
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Convection Simulation for different scheme at N = 256 \tau = 0.25');
legend('Decentered O3','Centered E2','Centered E4','Implicit I4','Implicit I6','Exact Solution');
grid on;
grid minor;
axis([0,256,-0.5,1.2]);
%% Plot tau 25
close all;
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

E2A = load('data/E2_256_25_dataA.txt');
E4A = load('data/E4_256_25_dataA.txt');
S3A = load('data/S3_256_25_dataA.txt');
I4A = load('data/I4_256_25_dataA.txt');
I6A = load('data/I6_256_25_dataA.txt');
figure;
hA = plot(S3A(:,1),S3A(:,2)*alpha,'-',E2A(:,1),E2A(:,2)*alpha,'--',E4A(:,1),E4A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hA(1),'linewidth',1);
set(hA(2),'linewidth',1);
set(hA(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Convection Simulation for different scheme at N = 256 \tau = 0.25');
legend('Decentered O3','Centered E2','Centered E4','Exact Solution');
grid on;
grid minor;
axis([0,256,-0.5,1.2]);
figure;
hB = plot(S3A(:,1),S3A(:,2)*alpha,I4A(:,1),I4A(:,2)*alpha,'--',I6A(:,1),I6A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hB(1),'linewidth',1);
set(hB(2),'linewidth',1);
set(hB(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Convection Simulation for different scheme at N = 256 \tau = 0.25');
legend('Decentered O3','Implicit I4','Implicit I6','Exact Solution');
grid on;
grid minor;
axis([0,256,-0.5,1.2]);

%% Plot tau 50
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

E2A = load('data/E2_256_50_dataA.txt');
E4A = load('data/E4_256_50_dataA.txt');
S3A = load('data/S3_256_50_dataA.txt');
I4A = load('data/I4_256_50_dataA.txt');
I6A = load('data/I6_256_50_dataA.txt');
figure;
hA = plot(S3A(:,1),S3A(:,2)*alpha,'-',E2A(:,1),E2A(:,2)*alpha,'--',E4A(:,1),E4A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hA(1),'linewidth',1);
set(hA(2),'linewidth',1);
set(hA(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Convection Simulation for different scheme at N = 256 \tau = 0.50');
legend('Decentered O3','Centered E2','Centered E4','Exact Solution');
grid on;
grid minor;
axis([0,256,-0.5,1.2]);
figure;
hB = plot(S3A(:,1),S3A(:,2)*alpha,I4A(:,1),I4A(:,2)*alpha,'--',I6A(:,1),I6A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hB(1),'linewidth',1);
set(hB(2),'linewidth',1);
set(hB(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Convection Simulation for different scheme at N = 256 \tau = 0.50');
legend('Decentered O3','Implicit I4','Implicit I6','Exact Solution');
grid on;
grid minor;
axis([0,256,-0.5,1.2]);
%% Plot tau 75
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

E2A = load('data/E2_256_75_dataA.txt');
E4A = load('data/E4_256_75_dataA.txt');
S3A = load('data/S3_256_75_dataA.txt');
I4A = load('data/I4_256_75_dataA.txt');
I6A = load('data/I6_256_75_dataA.txt');
figure;
hA = plot(S3A(:,1),S3A(:,2)*alpha,'-',E2A(:,1),E2A(:,2)*alpha,'--',E4A(:,1),E4A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hA(1),'linewidth',1);
set(hA(2),'linewidth',1);
set(hA(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Convection Simulation for different scheme at N = 256 \tau = 0.75');
legend('Decentered O3','Centered E2','Centered E4','Exact Solution');
grid on;
grid minor;
axis([0,256,-0.5,1.2]);
figure;
hB = plot(S3A(:,1),S3A(:,2)*alpha,I4A(:,1),I4A(:,2)*alpha,'--',I6A(:,1),I6A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hB(1),'linewidth',1);
set(hB(2),'linewidth',1);
set(hB(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Convection Simulation for different scheme at N = 256 \tau = 0.75');
legend('Decentered O3','Implicit I4','Implicit I6','Exact Solution');
grid on;
grid minor;
axis([0,256,-0.5,1.2]);
%% Plot tau 50
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

E2A = load('data/E2_256_100_dataA.txt');
E4A = load('data/E4_256_100_dataA.txt');
S3A = load('data/S3_256_100_dataA.txt');
I4A = load('data/I4_256_100_dataA.txt');
I6A = load('data/I6_256_100_dataA.txt');
figure;
hA = plot(S3A(:,1),S3A(:,2)*alpha,'-',E2A(:,1),E2A(:,2)*alpha,'--',E4A(:,1),E4A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hA(1),'linewidth',1);
set(hA(2),'linewidth',1);
set(hA(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Convection Simulation for different scheme at N = 256 \tau = 1.0');
legend('Decentered O3','Centered E2','Centered E4','Exact Solution');
grid on;
grid minor;
axis([0,256,-0.5,1.2]);
figure;
hB = plot(S3A(:,1),S3A(:,2)*alpha,I4A(:,1),I4A(:,2)*alpha,'--',I6A(:,1),I6A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hB(1),'linewidth',1);
set(hB(2),'linewidth',1);
set(hB(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Convection Simulation for different scheme at N = 256 \tau = 1.0');
legend('Decentered O3','Implicit I4','Implicit I6','Exact Solution');
grid on;
grid minor;
axis([0,256,-0.5,1.2]);
%% Plot diff 25
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

E2A = load('data/E2_128_25_diff_dataA.txt');
E4A = load('data/E4_128_25_diff_dataA.txt');
S3A = load('data/S3_128_25_diff_dataA.txt');
figure;
hA = plot(S3A(:,1),S3A(:,2)*alpha,'-',E2A(:,1),E2A(:,2)*alpha,'--',E4A(:,1),E4A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hA(1),'linewidth',1);
set(hA(2),'linewidth',1);
set(hA(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Conv-Diff Simulation for different scheme at N = 128 \tau = 0.25');
legend('Decentered O3','Centered E2','Centered E4','Exact Solution');
grid on;
grid minor;
axis([0,128,-0.5,1.2]);
% figure;
% hB = plot(S3A(:,1),S3A(:,2)*alpha,I4A(:,1),I4A(:,2)*alpha,'-+',I6A(:,1),I6A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
% set(hB(1),'linewidth',1);
% set(hB(2),'linewidth',1);
% set(hB(3),'linewidth',1);
% xlabel('N');
% ylabel('Adimensionalised u(x,t)');
% title('Convection Simulation for different scheme at N = 256 \tau = 1.0');
% legend('Decentered O3','Implicit I4','Implicit I6','Exact Solution');
% grid on;
% grid minor;
% axis([0,128,-0.5,1.2]);
%% Plot diff 50
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

E2A = load('data/E2_128_50_diff_dataA.txt');
E4A = load('data/E4_128_50_diff_dataA.txt');
S3A = load('data/S3_128_50_diff_dataA.txt');
figure;
hA = plot(S3A(:,1),S3A(:,2)*alpha,'-',E2A(:,1),E2A(:,2)*alpha,'--',E4A(:,1),E4A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hA(1),'linewidth',1);
set(hA(2),'linewidth',1);
set(hA(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Conv-Diff Simulation for different scheme at N = 128 \tau = 0.5');
legend('Decentered O3','Centered E2','Centered E4','Exact Solution');
grid on;
grid minor;
axis([0,128,-0.5,1.2]);
%% Plot diff 75
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

E2A = load('data/E2_128_75_diff_dataA.txt');
E4A = load('data/E4_128_75_diff_dataA.txt');
S3A = load('data/S3_128_75_diff_dataA.txt');
figure;
hA = plot(S3A(:,1),S3A(:,2)*alpha,'-',E2A(:,1),E2A(:,2)*alpha,'--',E4A(:,1),E4A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hA(1),'linewidth',1);
set(hA(2),'linewidth',1);
set(hA(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Conv-Diff Simulation for different scheme at N = 128 \tau = 0.75');
legend('Decentered O3','Centered E2','Centered E4','Exact Solution');
grid on;
grid minor;
axis([0,128,-0.5,1.2]);
%% Plot diff 100
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

E2A = load('data/E2_128_100_diff_dataA.txt');
E4A = load('data/E4_128_100_diff_dataA.txt');
S3A = load('data/S3_128_100_diff_dataA.txt');
I4A = load('data/I4_128_100_diff_dataA.txt');
I6A = load('data/I6_128_100_diff_dataA.txt');
figure;
hA = plot(S3A(:,1),S3A(:,2)*alpha,'-',E2A(:,1),E2A(:,2)*alpha,'--',E4A(:,1),E4A(:,2)*alpha,'--',S3A(:,1),S3A(:,3)*alpha,'black +');
set(hA(1),'linewidth',1);
set(hA(2),'linewidth',1);
set(hA(3),'linewidth',1);
xlabel('N');
ylabel('Adimensionalised u(x,t)');
title('Conv-Diff Simulation for different scheme at N = 128 \tau = 1.0');
legend('Decentered O3','Centered E2','Centered E4','Exact Solution');
grid on;
grid minor;
axis([0,128,-0.5,1.2]);

%% Error evolution Convection

E2B = load('data/E2_256_100_dataB.txt');
S3B = load('data/S3_256_100_dataB.txt');
E4B = load('data/E4_256_100_dataB.txt');
I4B = load('data/I4_256_100_dataB.txt');
I6B = load('data/I6_256_100_dataB.txt');
Ntime = length(S3B(:,1));
figure;
H1 = plot(S3B(:,1)/Ntime,S3B(:,2),'--',E2B(:,1)/Ntime,E2B(:,2),'--',E4B(:,1)/Ntime,E4B(:,2),'--',S3B(:,1)/Ntime,I4B(:,2),'--',S3B(:,1)/Ntime,I6B(:,2),'--');
set(H1(1),'linewidth',1);
legend('Decentered O3','Centered E2','Centered E4','Implicit I4','Implicit I6');
title('Global Diagnostic Q^n_h  N = 256');
xlabel('\tau');
ylabel('$$\frac{Q^n_h}{Q}$$','Interpreter','latex');
grid on;
grid minor;
figure;
H2 = plot(S3B(:,1)/Ntime,S3B(:,3)/S3B(1,3),'--',E2B(:,1)/Ntime,E2B(:,3)/E2B(1,3),'--',E4B(:,1)/Ntime,E4B(:,3)/E4B(1,3),'--',S3B(:,1)/Ntime,I4B(:,3)/I4B(1,3),'--',S3B(:,1)/Ntime,I6B(:,3)/I6B(1,3),'--');
set(H2(1),'linewidth',1);
legend('Decentered O3','Centered E2','Centered E4','Implicit I4','Implicit I6');
title('Global Diagnostic E^n_h  N = 256');
xlabel('\tau');
ylabel('$$\frac{E^n_h}{E(0)}$$','Interpreter','LaTex');
grid on;
grid minor;
figure;
H3 = plot(S3B(:,1)/Ntime,S3B(:,4)/sqrt(S3B(1,3)),'--',E2B(:,1)/Ntime,E2B(:,4)/sqrt(E2B(1,3)),'--',E4B(:,1)/Ntime,E4B(:,4)/sqrt(E4B(1,3)),'--',S3B(:,1)/Ntime,I4B(:,4)/sqrt(I4B(1,3)),'--',S3B(:,1)/Ntime,I6B(:,4)/sqrt(I6B(1,3)),'--');
set(H3(1),'linewidth',1);
legend('Decentered O3','Centered E2','Centered E4','Implicit I4','Implicit I6');
title('Global Diagnostic R^n_h  N = 256');
xlabel('\tau');
ylabel('$$\frac{R^n_h}{\sqrt{E(0)}}$$','Interpreter','LaTex');
grid on;
grid minor;
figure;
H4 = loglog(S3B(:,1)/Ntime,S3B(:,4)/sqrt(S3B(1,3)),'--',E2B(:,1)/Ntime,E2B(:,4)/sqrt(E2B(1,3)),'--',E4B(:,1)/Ntime,E4B(:,4)/sqrt(E4B(1,3)),'--',S3B(:,1)/Ntime,I4B(:,4)/sqrt(I4B(1,3)),'--',S3B(:,1)/Ntime,I6B(:,4)/sqrt(I6B(1,3)),'--');
set(H4(1),'linewidth',1);
legend('Decentered O3','Centered E2','Centered E4','Implicit I4','Implicit I6');
title('Global Diagnostic R^n_h  N = 256');
xlabel('\tau');
ylabel('$$\frac{R^n_h}{\sqrt{E(0)}}$$','Interpreter','LaTex');
grid on;
grid minor;
%% Error diag diff and conv
Ntime = length(S3B(:,1));
E2B = load('data/E2_128_100_diff_dataB.txt');
S3B = load('data/S3_128_100_diff_dataB.txt');
E4B = load('data/E4_128_100_diff_dataB.txt');
figure;
H1 = plot(S3B(:,1)/Ntime,S3B(:,2),'--',E2B(:,1)/Ntime,E2B(:,2),'--',E4B(:,1)/Ntime,E4B(:,2),'--');
set(H1(1),'linewidth',1);
legend('Decentered O3','Centered E2','Centered E4');
title('Global Diagnostic Q^n_h  N = 128');
xlabel('\tau');
ylabel('$$\frac{Q^n_h}{Q}$$','Interpreter','latex');
grid on;
grid minor;
figure;
H2 = plot(S3B(:,1)/Ntime,S3B(:,3)/S3B(1,3),'--',E2B(:,1)/Ntime,E2B(:,3)/E2B(1,3),'--',E4B(:,1)/Ntime,E4B(:,3)/E4B(1,3),'--');
set(H2(1),'linewidth',1);
legend('Decentered O3','Centered E2','Centered E4');
title('Global Diagnostic E^n_h  N = 128');
xlabel('\tau');
ylabel('$$\frac{E^n_h}{E(0)}$$','Interpreter','LaTex');
grid on;
grid minor;
figure;
H3 = plot(S3B(:,1)/Ntime,S3B(:,4)/sqrt(S3B(1,3)),'--',E2B(:,1)/Ntime,E2B(:,4)/sqrt(E2B(1,3)),'--',E4B(:,1)/Ntime,E4B(:,4)/sqrt(E4B(1,3)),'--');
set(H3(1),'linewidth',1);
legend('Decentered O3','Centered E2','Centered E4');
title('Global Diagnostic R^n_h  N = 128');
xlabel('\tau');
ylabel('$$\frac{R^n_h}{\sqrt{E(0)}}$$','Interpreter','LaTex');
grid on;
grid minor;
figure;
H4 = loglog(S3B(:,1)/Ntime,S3B(:,4)/sqrt(S3B(1,3)),'--',E2B(:,1)/Ntime,E2B(:,4)/sqrt(E2B(1,3)),'--',E4B(:,1)/Ntime,E4B(:,4)/sqrt(E4B(1,3)),'--');
set(H4(1),'linewidth',1);
legend('Decentered O3','Centered E2','Centered E4');
title('Global Diagnostic R^n_h  N = 128');
xlabel('\tau');
ylabel('$$\frac{R^n_h}{\sqrt{E(0)}}$$','Interpreter','LaTex');
grid on;
grid minor;
%% Comparison
L = 1; 
Q = 1;
sigma = L/32;
alpha = sqrt(pi*sigma*sigma)/Q; 

S3A1 = load('data/S3_128_75_diff_dataA.txt');
S3A2 = load('data/S3_128_75_dataA.txt');
figure;
plot(S3A1(:,1),S3A1(:,2)*alpha,S3A2(:,1),S3A2(:,2)*alpha);
legend('Convection','Convection and Diffusion');
title('Comparison between Conv and Conv-Diff N = 128 \tau = 0.75');
xlabel('N');
ylabel('$$\frac{U \sqrt{\pi \sigma^2} }{Q}$$','Interpreter','LaTex');
grid on;
grid minor;

S3B1 = load('data/S3_128_75_diff_dataB.txt');
S3B2 = load('data/S3_128_75_dataB.txt');
figure;
plot(S3B1(:,1),S3B1(:,2),S3B2(:,1),S3B2(:,2));
legend('Convection','Convection and Diffusion');
title('Global Diagnostic Q^n_h  N = 128');
xlabel('\tau');
ylabel('$$\frac{Q^n_h}{Q(0)}$$','Interpreter','LaTex');
grid on;
grid minor;
figure;
plot(S3B1(:,1),S3B1(:,3)/S3B1(1,3),S3B2(:,1),S3B2(:,3)/S3B2(1,3));
legend('Convection','Convection and Diffusion');
title('Global Diagnostic E^n_h  N = 128');
xlabel('\tau');
ylabel('$$\frac{E^n_h}{E(0)}$$','Interpreter','LaTex');
grid on;
grid minor;
figure;
plot(S3B1(:,1),S3B1(:,4)/sqrt(S3B1(1,3)),S3B2(:,1),S3B2(:,4)/sqrt(S3B2(1,3)));
legend('Convection','Convection and Diffusion');
title('Global Diagnostic R^n_h  N = 128');
xlabel('\tau');
ylabel('$$\frac{R^n_h}{\sqrt{E(0)}}$$','Interpreter','LaTex');
grid on;
grid minor;
%% GNAA HAN ! 
S3B064 = load('data/S3_64_100_dataB.txt');
S3B128 = load('data/S3_128_100_dataB.txt');
S3B256 = load('data/S3_256_100_dataB.txt');
E2B064 = load('data/E2_64_100_dataB.txt');
E2B128 = load('data/E2_128_100_dataB.txt');
E2B256 = load('data/E2_256_100_dataB.txt');
E4B064 = load('data/E4_64_100_dataB.txt');
E4B128 = load('data/E4_128_100_dataB.txt');
E4B256 = load('data/E4_256_100_dataB.txt');
I4B064 = load('data/I4_64_100_dataB.txt');
I4B128 = load('data/I4_128_100_dataB.txt');
I4B256 = load('data/I4_256_100_dataB.txt');
I6B064 = load('data/I6_64_100_dataB.txt');
I6B128 = load('data/I6_128_100_dataB.txt');
I6B256 = load('data/I6_256_100_dataB.txt');

XARNH =  [1/2 1/4 1/8];
S3RNH = [S3B064(length(S3B064),4)/sqrt(S3B064(1,3)),S3B128(length(S3B128),4)/sqrt(S3B128(1,3)),S3B256(length(S3B256),4)/sqrt(S3B256(1,3))];
E2RNH = [E2B064(length(E2B064),4)/sqrt(E2B064(1,3)),E2B128(length(E2B128),4)/sqrt(E2B128(1,3)),E2B256(length(E2B256),4)/sqrt(E2B256(1,3))];
E4RNH = [E4B064(length(E4B064),4)/sqrt(E4B064(1,3)),E4B128(length(E4B128),4)/sqrt(E4B128(1,3)),E4B256(length(E4B256),4)/sqrt(E4B256(1,3))];
I4RNH = [I4B064(length(I4B064),4)/sqrt(I4B064(1,3)),I4B128(length(I4B128),4)/sqrt(I4B128(1,3)),I4B256(length(I4B256),4)/sqrt(I4B256(1,3))];
I6RNH = [I6B064(length(I6B064),4)/sqrt(I6B064(1,3)),I6B128(length(I6B128),4)/sqrt(I6B128(1,3)),I6B256(length(I6B256),4)/sqrt(I6B256(1,3))];
loglog(XARNH,S3RNH,XARNH,E2RNH,XARNH,E4RNH,XARNH,I4RNH,XARNH,I6RNH);
legend('Decentered O3','Centered E2','Centered E4','Implicit I4','Implicit I6');
xlabel('$$\frac{h}{\sigma}$$','Interpreter','LaTex');
ylabel('Rnh');
title('Global Error at \tau = 1.0');
grid on;
grid minor;